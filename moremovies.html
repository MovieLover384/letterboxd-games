<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Who Has More Movies Watched?</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
<link rel="stylesheet" href="moremovies.css">
</head>
<body class="flex flex-col min-h-screen">

<header class="bg-film-surface backdrop-blur-md border-b border-gray-800 sticky top-0 z-50">
  <div class="container mx-auto px-4 py-4 flex items-center justify-between">
    <a href="letterboxd-game/index.html" class="flex items-center gap-2">
      <div class="w-9 h-9 rounded-lg bg-orange-500 flex items-center justify-center">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-5 h-5 text-white">
          <path d="M3 3h18v18H3V3zm2 2v14h14V5H5z"/>
        </svg>
      </div>
      <span class="text-xl font-serif font-bold">Letterboxd <span class="text-gradient-accent">Games</span></span>
    </a>
    <nav class="flex items-center gap-6">
      <a href="letterboxd-game/index.html" class="hover:text-white transition">Home</a>
      <a href="letterboxd-game/info.html" class="hover:text-white transition">Info</a>
    </nav>
  </div>
</header>

<section class="relative text-center py-24 md:py-32 bg-gradient-to-br from-gray-900 via-gray-800 to-green-900 overflow-hidden">
  <div class="relative z-10 max-w-3xl mx-auto px-4">
    <h1 class="text-5xl md:text-6xl font-bold mb-4">Who Has <span class="text-gradient-accent">Watched More Movies?</span></h1>
    <p class="text-lg md:text-xl text-gray-400">Guess who has watched more films based on their top 4 favorites.</p>
  </div>
</section>

<section class="container mx-auto px-4 py-12 flex-1 text-center">
  <div id="score" class="text-lg font-semibold mb-4">Score: 0</div>
  <div class="flex justify-center mb-8">
  <div id="players" class="grid grid-cols-1 md:grid-cols-2 gap-12"></div>
  </div>
  <div id="buttons" class="flex justify-center gap-6 mb-6">
    <button id="chooseLeft" class="bg-orange-500 hover:bg-orange-600 text-black px-6 py-3 font-semibold rounded-lg text-lg transition">Left</button>
    <button id="chooseRight" class="bg-orange-500 hover:bg-orange-600 text-black px-6 py-3 font-semibold rounded-lg text-lg transition">Right</button>
  </div>
  <div id="result" class="text-lg font-semibold mb-6"></div>
  <div id="nextBtnContainer" class="mb-6 hidden">
    <button id="nextUsersBtn" class="bg-green-500 hover:bg-green-600 text-black px-6 py-3 font-semibold rounded-lg text-lg transition">Next Users</button>
  </div>
  <div class="flex justify-center gap-4">
    <button id="playAgainBtn" class="bg-orange-500 hover:bg-orange-600 text-black px-5 py-2 font-semibold rounded-lg transition">Play Again</button>
  </div>
</section>


<footer class="bg-film-surface border-t border-gray-800 py-12 text-center mt-auto">
  <h3 class="text-orange-500 mb-2">
    Letterboxd Games ~ Fan project, Not affiliated with Letterboxd
  </h3>
  <p class="text-gray-400 mb-1 flex items-center justify-center gap-2">
    Made with
    <svg width="18" height="18" viewBox="0 0 24 24" class="inline-block">
      <defs>
        <linearGradient id="heartGradient" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" stop-color="hsl(25,95%,55%)"/>
          <stop offset="100%" stop-color="hsl(35,90%,60%)"/>
        </linearGradient>
      </defs>
      <path
        d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 
           2 6 4 4 6.5 4 
           8.24 4 9.91 5.01 10.44 6.36 
           10.97 5.01 12.64 4 14.38 4 
           16.88 4 18.88 6 18.88 8.5 
           18.88 12.28 15.48 15.36 10.33 20.04L12 21.35z"
        fill="url(#heartGradient)"
      />
    </svg>
    for film lovers
  </p>
  <p class="text-gray-400">
    Follow me on 
    <a href="https://letterboxd.com/MovieLover384/" target="_blank" class="text-orange-500 hover:text-orange-400 underline">
      Letterboxd
    </a>
  </p>
</footer>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script>
let members = [];
let favorites = [];
let leftPlayer = null;
let rightPlayer = null;
let score = 0;

async function loadData() {
    members = await fetch('members.json').then(res => res.json());
    favorites = await fetch('4fav.json').then(res => res.json());
    startNewRound();
}

function startNewRound() {
    document.getElementById('nextBtnContainer').classList.add('hidden');
    const btnLeft = document.getElementById('chooseLeft');
    const btnRight = document.getElementById('chooseRight');
    btnLeft.disabled = false;
    btnRight.disabled = false;
    btnLeft.classList.remove('opacity-50','cursor-not-allowed');
    btnRight.classList.remove('opacity-50','cursor-not-allowed');

    do {
        leftPlayer = members[Math.floor(Math.random() * members.length)];
        rightPlayer = members[Math.floor(Math.random() * members.length)];
    } while (leftPlayer.username === rightPlayer.username);

    displayPlayers();
    document.getElementById('result').innerHTML = "";
}

function displayPlayers() {
    const container = document.getElementById('players');
    container.innerHTML = "";

    [leftPlayer, rightPlayer].forEach(player => {
        const favs = favorites.find(f => f.username === player.username)?.favorites || [];
        const div = document.createElement('div');
        div.className = "flex flex-col items-center gap-3";
        div.innerHTML = `
            <h3 class="text-2xl font-bold text-gradient-accent">${player.username}</h3>
            <div class="grid grid-cols-2 gap-2">
                ${favs.map(f => `
                    <div class="relative group">
                        <img src="${f.poster_url}" alt="${f.title}" class="w-32 rounded-lg favorite-poster">
                        <div class="absolute inset-0 bg-black bg-opacity-70 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 rounded-lg text-center p-2 transition-opacity">
                            ${f.title}
                        </div>
                    </div>
                `).join('')}
            </div>
        `;
        container.appendChild(div);
    });
}

function guess(playerSide) {
    const leftFilms = leftPlayer.stats.films;
    const rightFilms = rightPlayer.stats.films;
    const correctSide = leftFilms >= rightFilms ? 'left' : 'right';
    const resultDiv = document.getElementById('result');

    const btnLeft = document.getElementById('chooseLeft');
    const btnRight = document.getElementById('chooseRight');
    btnLeft.disabled = true;
    btnRight.disabled = true;
    btnLeft.classList.add('opacity-50','cursor-not-allowed');
    btnRight.classList.add('opacity-50','cursor-not-allowed');

    if (playerSide === correctSide) {
        score++;
        document.getElementById('score').innerText = `Score: ${score}`;
        resultDiv.innerHTML = `Correct! ${leftPlayer.username}: ${leftFilms} | ${rightPlayer.username}: ${rightFilms}`;
        resultDiv.className = "text-green-400 text-lg font-semibold mb-4 text-center";
        confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
        document.getElementById('nextBtnContainer').classList.remove('hidden');
    } else {
        resultDiv.innerHTML = `Wrong! ${leftPlayer.username}: ${leftFilms} | ${rightPlayer.username}: ${rightFilms}`;
        resultDiv.className = "text-red-500 text-lg font-semibold mb-4 text-center";
    }
}

document.getElementById('chooseLeft').addEventListener('click', () => guess('left'));
document.getElementById('chooseRight').addEventListener('click', () => guess('right'));
document.getElementById('playAgainBtn').addEventListener('click', () => {
    score = 0;
    document.getElementById('score').innerText = `Score: ${score}`;
    startNewRound();
});
document.getElementById('nextUsersBtn').addEventListener('click', startNewRound);

loadData();
</script>
</body>
</html>